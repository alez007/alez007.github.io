## Cognito Sign Up / Sign In - Introduction

Main aim of this article is to exemplify a simple registration and login with AWS. We'll use Cognito, Lambda, API Gateway and DynamoDB. 

### What is Cognito ? 
It's an authentication and authorization service. What's the difference ? Well, *authentication* authenticates, *authorization* authorizes. 

What I mean is, if you sign in with your username and password, you *authenticate* yourself into the system.This means the system agrees you are a valid identity, but not necessarily one that is *authorized* to access certain parts of it. *Authorization* is your permission to see or access certain parts of the system you're *authenticated* into.

There are two main parts of Cognito, one is **User Pools**, the other is **Federated Identities**. 

#### User Pools
***
**User Pools** handles *authentication*. It supports pretty much everything you can think of, sign up, sign in with or without third party services (Facebook, Google, Amazon etc.), multi-factor authentication, message verification, analytics and it can be scaled with lambda triggers. Any successful signin attempt with **User Pools** provides *tokens* that you can use either to gain access in your server side app, gain access to AWS API Gateway or exchange them for temporary *AWS Credentials* to gain access to *AWS Services*.

One importand part of **User Pools** is the **App Client**. 

###### *App Client*
Think of the _**App Client**_ as the access point for the data stored in **User Pools**. Without creating one, you won't be able to *authenticate*. 

_**App Client**_ has predefined access rights to **User Pool** data, e.g. a list of user attributes that can be read or written during the *authentication* process, information about the refresh token expity time, an App ID (generated by Cognito) and and optional APP Secret (also generated by Cognito). 

`Why the trouble?` Well, *user pools* can have multiple *app clients* and each _**App Client**_ can be configured with different access levels to that data. If you think of similarities with Facebook Developer Apps then you would be right. 

When **User Pool** generates token upon a successful *authentication*, that `token` is actually `tokens` because it actually generates three of them, one ID Token, one Access Token and one Refresh Token. The information encoded inside these tokens is, in fact, controlled by the _**App Client**_. ID Token will only contain user attributes the _**App Client**_ has access to, Access Token will only contain information about the level of access the user is entitled to (think *authorization*) and the Refresh Token contains information about how to refresh the previous two tokens.

All three tokens are JWT tokens and if you feel like digging more about it, or even find out about libraries that can decode these tokens, feel free to read [this](https://openid.net/specs/openid-connect-core-1_0.html) and [this](https://openid.net/developers/jwt/).

#### Federated Identities
***
**Federated Identities** handles *authorization*. This component stores identity data in *identity pools* and doesn't support *authentication*, therefore it relies on separate *authentication providers* that can be anything from an already created **User Pool** to *SAML* and even a custom authentication provider. What this means is that another *authentication provider* will issue an access token, like **User Pools** for example, then **Federated Identities** consumes that token and exchanges it with *AWS Credentials* which, in return, provide access to *AWS Services*. 

### 'Nuf talk, let's play
##### What's the exercise ? 
Let's presume you've got a web app that already has a sign-up or sign-in process in place and you're thinking to decouple that part of your app and do the sign-up and sign-in via Cognito. Now, in this exercise, we don't really need access to any AWS services, do we, therefore it's safe to assume that we'll only use one part of Cognito, meaning only **User Pools**. The scenario looks like this:
  
  ![Standalone Scenario](/static/img/articles/cognito_sign_up_sign_in/scenario-standalone.png)
  
In the above scenario, we'll authenticate users with **User Pools** and once we have a successful authentication, we give them access to our existent app. This means that your existent app should answer the following question: `Is this user authenticated?`. If yes, allow them access, if not, do something else. 

##### Set Up
First, we'll need an AWS account. If you don't have one yet, go to [AWS Console](https://aws.amazon.com/console/). 

  
